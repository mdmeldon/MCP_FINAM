# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –º–æ—â–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –±–∞–∑–µ Plotly, –∫–æ—Ç–æ—Ä–∞—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å LangChain –∞–≥–µ–Ω—Ç–æ–º –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. **Sunburst –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è**

- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∞–∫—Ç–∏–≤–æ–≤ –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º —ç–∫–æ–Ω–æ–º–∏–∫–∏
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º (—Å–µ–∫—Ç–æ—Ä ‚Üí –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (–∑–µ–ª–µ–Ω—ã–π - –ø—Ä–∏–±—ã–ª—å, –∫—Ä–∞—Å–Ω—ã–π - —É–±—ã—Ç–æ–∫)
- –†–∞–∑–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏

### 2. **–ì—Ä–∞—Ñ–∏–∫ —Å–¥–µ–ª–æ–∫ –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏**

- –õ–∏–Ω–∏—è –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ó–µ–ª–µ–Ω—ã–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ –≤–≤–µ—Ä—Ö üî∫ –¥–ª—è —Ç–æ—á–µ–∫ –≤—Ö–æ–¥–∞ (–ø–æ–∫—É–ø–æ–∫)
- –ö—Ä–∞—Å–Ω—ã–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ –≤–Ω–∏–∑ üîª –¥–ª—è —Ç–æ—á–µ–∫ –≤—ã—Ö–æ–¥–∞ (–ø—Ä–æ–¥–∞–∂)
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Å –¥–µ—Ç–∞–ª—è–º–∏ —Å–¥–µ–ª–æ–∫

### 3. **–ö—Ä–∏–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏**

- –ì—Ä–∞—Ñ–∏–∫ —Ä–æ—Å—Ç–∞ –∫–∞–ø–∏—Ç–∞–ª–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏
- –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫:
  - –ò—Ç–æ–≥–æ–≤—ã–π –∫–∞–ø–∏—Ç–∞–ª
  - –û–±—â–∞—è –ø—Ä–∏–±—ã–ª—å
  - –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –≤ %
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
  - –í–∏–Ω—Ä–µ–π—Ç (–ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫)

### 4. **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫**

- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–Ω –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –õ–µ–≥–µ–Ω–¥–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ß–µ—Ä–µ–∑ —á–∞—Ç —Å –∞–≥–µ–Ω—Ç–æ–º

–ü—Ä–æ—Å—Ç–æ –∑–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ:

#### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

**–ö–µ–π—Å 1: –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫**

```
"–ü—Ä–æ–≤–µ–¥–∏ –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –º–æ–µ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è. –ü–æ–∫–∞–∂–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º
–∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–æ–≤."
```

**–ö–µ–π—Å 2: –ë—ç–∫—Ç–µ—Å—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**

```
"–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ SBER –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞: –ø–æ–∫—É–ø–∫–∞ –ø—Ä–∏ RSI < 30,
–ø—Ä–æ–¥–∞–∂–∞ –ø—Ä–∏ RSI > 70. –ü–æ–∫–∞–∂–∏ –≥—Ä–∞—Ñ–∏–∫ —Å–¥–µ–ª–æ–∫ –∏ –∫—Ä–∏–≤—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏."
```

**–ö–µ–π—Å 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤**

```
"–°—Ä–∞–≤–Ω–∏ –¥–∏–Ω–∞–º–∏–∫—É –∞–∫—Ü–∏–π –Ø–Ω–¥–µ–∫—Å–∞, –°–±–µ—Ä–±–∞–Ω–∫–∞ –∏ –ì–∞–∑–ø—Ä–æ–º–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–≤–∞—Ä—Ç–∞–ª.
–ü–æ–∫–∞–∂–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –∫–∞–∫–∏–µ –ø–æ–∫–∞–∑–∞–ª–∏ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç."
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–∏–º–µ—Ä 1: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è

```python
from src.presentation.langchain.tools.visualization import visualize_portfolio

# –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–∑ MCP
account_json = '{"positions": [...], "equity": {...}}'

# –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é
result = visualize_portfolio(account_json)
print(result)
```

#### –ü—Ä–∏–º–µ—Ä 2: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±—ç–∫—Ç–µ—Å—Ç–∞

```python
from src.presentation.langchain.tools.visualization import visualize_strategy_backtest

# –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
bars_json = '{"bars": [{"timestamp": "...", "close": {...}}]}'

# –°–¥–µ–ª–∫–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
trades_json = '[{"timestamp": "...", "price": {...}, "side": "SIDE_BUY"}]'

# –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
result = visualize_strategy_backtest(
    bars_data=bars_json,
    trades_data=trades_json,
    initial_capital=100000
)
print(result)
```

#### –ü—Ä–∏–º–µ—Ä 3: –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫

```python
from src.presentation.langchain.tools.visualization import create_comparison_chart

instruments_json = '''[
    {"symbol": "SBER@TQBR", "bars": [...]},
    {"symbol": "GAZP@TQBR", "bars": [...]}
]'''

result = create_comparison_chart(instruments_json)
print(result)
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
src/presentation/langchain/
‚îú‚îÄ‚îÄ visualization/              # –ú–æ–¥—É–ª–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ portfolio.py           # Sunburst –¥–∏–∞–≥—Ä–∞–º–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ trades.py              # –ì—Ä–∞—Ñ–∏–∫ —Å–¥–µ–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ performance.py         # –ö—Ä–∏–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ utils.py               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îî‚îÄ‚îÄ tools/                      # LangChain –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ visualization.py        # –û–±–µ—Ä—Ç–∫–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–∞
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    ‚Üì
Streamlit UI (–∑–∞–ø—Ä–æ—Å –≤ —á–∞—Ç)
    ‚Üì
LangChain Agent (–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞)
    ‚Üì
MCP Tools (–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Finam API)
    ‚Üì
Visualization Tools (—Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤)
    ‚Üì
Session State (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π)
    ‚Üì
Streamlit UI (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤)
```

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ–∫—Ç–æ—Ä–æ–≤

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `visualization/utils.py`:

```python
SECTOR_MAPPING = {
    "–ù–û–í–´–ô–¢–ò–ö–ï–†": "–ù–æ–≤—ã–π —Å–µ–∫—Ç–æ—Ä",
    # ... –¥—Ä—É–≥–∏–µ —Ç–∏–∫–µ—Ä—ã
}
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã

–í `portfolio.py`:

```python
color_continuous_scale=[
    [0, "rgb(220, 50, 50)"],      # –¶–≤–µ—Ç –¥–ª—è —É–±—ã—Ç–∫–æ–≤
    [0.5, "rgb(240, 240, 240)"],  # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π
    [1, "rgb(50, 200, 50)"]       # –¶–≤–µ—Ç –¥–ª—è –ø—Ä–∏–±—ã–ª–∏
]
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫

–†–∞—Å—à–∏—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `calculate_metrics` –≤ `performance.py`:

```python
def calculate_metrics(trades, initial_capital):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏

    # –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    sharpe_ratio = calculate_sharpe_ratio(returns)
    sortino_ratio = calculate_sortino_ratio(returns)

    return {
        # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
        "Sharpe Ratio": f"{sharpe_ratio:.2f}",
        "Sortino Ratio": f"{sortino_ratio:.2f}",
    }
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
uv run streamlit run server.py
```

2. –í–≤–µ–¥–∏—Ç–µ Finam API —Ç–æ–∫–µ–Ω –∏ Account ID –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏

3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–∞–∂–¥—ã–π –∫–µ–π—Å:
   - "–ü–æ–∫–∞–∂–∏ –º–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π"
   - "–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω–∞ SBER –∑–∞ –º–µ—Å—è—Ü"
   - "–°—Ä–∞–≤–Ω–∏ SBER –∏ GAZP –∑–∞ –Ω–µ–¥–µ–ª—é"

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:

- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (zoom, pan, hover)
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –¶–≤–µ—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å" —É–¥–∞–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–µ–π—Å–æ–≤ —Ö–∞–∫–∞—Ç–æ–Ω–∞

### –ö–µ–π—Å 1: –ü–æ—Ä—Ç—Ñ–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫

**–ó–∞–ø—Ä–æ—Å:**

```
–ü—Ä–æ–≤–µ–¥–∏ –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –º–æ–µ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è. –ü–æ–∫–∞–∂–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É,
–¥–∏–Ω–∞–º–∏–∫—É –∏ –ø—Ä–µ–¥–ª–æ–∂–∏, –∫–∞–∫ –µ–≥–æ –º–æ–∂–Ω–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å.
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≥–µ–Ω—Ç:**

1. –í—ã–∑—ã–≤–∞–µ—Ç `get_account` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
2. –í—ã–∑—ã–≤–∞–µ—Ç `visualize_portfolio` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Sunburst –¥–∏–∞–≥—Ä–∞–º–º—ã
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º
4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ

### –ö–µ–π—Å 2: –†—ã–Ω–æ—á–Ω—ã–π —Å–∫–∞–Ω–µ—Ä

**–ó–∞–ø—Ä–æ—Å:**

```
–ù–∞–π–¥–∏ –≤—Å–µ –∞–∫—Ü–∏–∏ –Ω–∞ –ú–æ—Å–±–∏—Ä–∂–µ –∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã—Ä–æ—Å–ª–∏
–±–æ–ª–µ–µ —á–µ–º –Ω–∞ 5% –∑–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é. –ü–æ–∫–∞–∂–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏.
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≥–µ–Ω—Ç:**

1. –í—ã–∑—ã–≤–∞–µ—Ç `assets` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
2. –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ —Å–µ–∫—Ç–æ—Ä—É –∏ –∫—Ä–∏—Ç–µ—Ä–∏—è–º
3. –ü–æ–ª—É—á–∞–µ—Ç `bars` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
4. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `create_comparison_chart` –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

### –ö–µ–π—Å 3: –ü–µ—Å–æ—á–Ω–∏—Ü–∞ –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–ó–∞–ø—Ä–æ—Å:**

```
–ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∞—Ä–±–∏—Ç—Ä–∞–∂–∞ –º–µ–∂–¥—É SBER –∏ SBERP –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞.
–í—Ö–æ–¥ –∫–æ–≥–¥–∞ —Å–ø—Ä–µ–¥ —Ä–∞—Å—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ 150 –ø—É–Ω–∫—Ç–æ–≤, –≤—ã—Ö–æ–¥ –ø—Ä–∏ —Å—Ö–æ–∂–¥–µ–Ω–∏–∏ –¥–æ 20.
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∞–≥–µ–Ω—Ç:**

1. –ü–æ–ª—É—á–∞–µ—Ç `bars` –¥–ª—è –æ–±–æ–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
2. –°–∏–º—É–ª–∏—Ä—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (—Ä–∞—Å—á–µ—Ç —Å–ø—Ä–µ–¥–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–¥–µ–ª–æ–∫)
3. –í—ã–∑—ã–≤–∞–µ—Ç `visualize_strategy_backtest` –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –¥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–ø—Ä–æ—Å–∞

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `st.session_state["visualizations"]` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç JSON –¥–∞–Ω–Ω—ã—Ö

### –û—à–∏–±–∫–∞ "Invalid JSON"

**–ü—Ä–æ–±–ª–µ–º–∞:** `JSONDecodeError` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ MCP –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞, –∞ –Ω–µ –æ–±—ä–µ–∫—Ç
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `json.dumps()` –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –ú–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–≤–µ—Ä–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ—Å–∞–¥–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –ø–æ–ª—è `side` –≤ —Å–¥–µ–ª–∫–∞—Ö
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ü–µ–Ω—ã –∏ —Ä–∞–∑–º–µ—Ä—ã –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `calculate_metrics()`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Plotly](https://plotly.com/python/)
- [Streamlit Components](https://docs.streamlit.io/develop/api-reference)
- [LangChain Tools](https://python.langchain.com/docs/modules/tools/)
- [Finam Trade API](https://github.com/FinamWeb/finam-trade-api)

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö –∫–µ–π—Å–æ–≤ —Ö–∞–∫–∞—Ç–æ–Ω–∞. –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

–£–¥–∞—á–∏ –Ω–∞ —Ö–∞–∫–∞—Ç–æ–Ω–µ! üöÄ
